<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/_layout :: layout(~{::pageContent}, ~{::pageCss}, ~{::pageJs}, ${title})}">

<!-- ✅ Page-specific CSS -->
<th:block th:fragment="pageCss">
    
</th:block>

<!-- ✅ Page Content -->
<th:block th:fragment="pageContent">
    <!-- Success / Errors -->
    <div th:if="${message}" th:text="${message}" class="alert alert-success">
    </div>

    <div th:if="${error}" th:text="${error}" class="alert alert-danger">
    </div>

    <!-- Quiz Details Section -->
    <div class="quiz-details-section" th:if="${quiz}">
        <h2 class="section-title"><i class="fas fa-info-circle"></i> Quiz Details</h2>
        <form id="quizForm" th:action="@{/admin/update-quiz}" th:object="${quiz}" method="post" novalidate>
            <input type="hidden" name="id" th:value="${quiz.id}">

            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="quizTitle" class="form-label">Quiz Title <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" id="quizTitle" name="title"
                           th:value="${quiz.title}" placeholder="Enter quiz title" required>
                    <div class="invalid-feedback" id="titleError"></div>
                </div>

                <div class="col-md-6 mb-3">
                    <label for="timeLimitMinutes" class="form-label">Time Limit (minutes) <span
                            class="text-danger">*</span></label>
                    <input type="number" class="form-control" id="timeLimitMinutes" name="timeLimitMinutes"
                           th:value="${quiz.timeLimitMinutes}" placeholder="Enter time limit" min="1" max="180"
                           required>
                    <div class="invalid-feedback" id="timeLimitMinutesError"></div>
                </div>
            </div>

            <div class="mb-3">
                <label for="quizDescription" class="form-label">Description <span class="text-danger">*</span></label>
                <textarea class="form-control" id="quizDescription" name="description" rows="4"
                          placeholder="Enter quiz description" required th:text="${quiz.description}"></textarea>
                <div class="invalid-feedback" id="descriptionError"></div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-update">
                    <i class="fas fa-save"></i> Update Quiz
                </button>
            </div>
        </form>
        <form th:action="@{'/admin/delete-quiz/' + ${quiz.id}}" method="post">
            <button type="submit" class="btn btn-sm btn-outline-danger">Delete</button>
        </form>
    </div>

    <!-- Questions Section -->
    <div class="questions-section mt-4" th:if="${quiz}">
        <h2 class="mb-4 fw-bold text-primary">
            <i class="bi bi-question-circle"></i>
            Quiz Questions
        </h2>

        <!-- No questions yet -->
        <div th:if="${#lists.isEmpty(quiz.questions)}" class="alert alert-info text-center py-4 shadow-sm">
            <i class="bi bi-inbox fs-3"></i>
            <p class="mt-2 mb-0">No questions added yet. Create your first question below!</p>
        </div>

        <!-- Questions list -->
        <div th:unless="${#lists.isEmpty(quiz.questions)}" class="row g-3">
            <div class="col-md-6 col-lg-4" th:each="question : ${quiz.questions}">
                <div class="card shadow-sm border-0 rounded-4 h-100">
                    <div class="card-body d-flex flex-column justify-content-between">
                        <div class="mb-3">
                            <h6 class="fw-semibold text-dark" th:text="${question.question}">Sample Question</h6>
                        </div>

                        <div class="d-flex justify-content-end gap-2 mt-auto">
                            <a th:href="@{'/admin/update-quiz-question/' + ${question.id}}"
                               class="btn btn-outline-primary btn-sm">
                                <i class="bi bi-pencil-square"></i> Edit
                            </a>
                            <a th:href="@{'/admin/delete-quiz-question/' + ${question.id}}"
                               class="btn btn-outline-danger btn-sm"
                               onclick="return confirm('Are you sure you want to delete this question?');">
                                <i class="bi bi-trash"></i> Delete
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Question Button -->
        <div class="text-center mt-4">
            <a th:href="@{'/admin/add-quiz-question/' + ${quiz.id}}"
               class="btn btn-primary btn-lg shadow-sm rounded-pill px-4">
                <i class="bi bi-plus-circle"></i> Add New Question
            </a>
        </div>
    </div>

</th:block>

<!-- ✅ Page-specific JS (optional) -->
<th:block th:fragment="pageJs"></th:block>

</html>